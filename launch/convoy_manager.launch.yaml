## Online Convoy Manger
session_name: vtr_convoy_manager
environment:
  RMW_IMPLEMENTATION: rmw_zenoh_cpp
  ZENOH_ROUTER_CONFIG_URI: $VTRROOT/lelr/lelr_zenoh_router_config.json5
  ROBOTS: "[echo,foxtrot]" # Figure out how to easily make this configurable

start_directory: ${VTRDATA}
suppress_history: false

windows:
  - window_name: vtr_gui
    layout: main-horizontal
    shell_command_before:
      - source ${VTRSRC}/main/install/setup.bash
    panes:
      - ros2 run vtr_gui multi_robot_socket_client --ros-args -p robots:=$ROBOTS
      - ros2 run vtr_gui multi_robot_socket_server --ros-args -p robots:=$ROBOTS
      - ros2 run vtr_gui multi_robot_web_server --ros-args -p robots:=$ROBOTS
      # - firefox --new-window "localhost:5200" # the webpage has to wait for everything above

  - window_name: convoy_manager
    layout: main-horizontal
    shell_command_before:
      - source ${VTRSRC}/main/install/setup.bash
    panes:
      - >
        ros2 launch vtr_multi_robot convoy_route_planner.launch.py
        robots:=$ROBOTS base_params:=ouster_lelr_default.yaml convoy_params:=lelr_convoy.yaml

  - window_name: rosbag
    layout: main-horizontal
    shell_command_before:
      - source ${VTRSRC}/main/install/setup.bash
    panes:
      - ros2 bag record /echo/cmd_vel /foxtrot/cmd_vel /echo/vtr/mpc_prediction /foxtrot/vtr/mpc_prediction /echo/vtr/odometry /foxtrot/vtr/odometry /echo/vtr/leader_mpc_prediction /foxtrot/vtr/leader_mpc_prediction